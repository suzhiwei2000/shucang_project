{"version":3,"sources":["uni-app:///main.js","webpack:///D:/webProject/前端数藏/前端uniapp11/pages/invite/invitePoster.vue?b19e","webpack:///D:/webProject/前端数藏/前端uniapp11/pages/invite/invitePoster.vue?5671","webpack:///D:/webProject/前端数藏/前端uniapp11/pages/invite/invitePoster.vue?f7c1","webpack:///D:/webProject/前端数藏/前端uniapp11/pages/invite/invitePoster.vue?bc7e","uni-app:///pages/invite/invitePoster.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":";;;;;;;;;;kDAAA;;;AAGA;AACA,4G,8FAHA;AACAA,EAAE,CAACC,iCAAH,GAAuCC,mBAAvC,CAGAC,UAAU,CAACC,qBAAD,CAAV,C;;;;;;;;;;;;;ACLA;AAAA;AAAA;AAAA;AAAA;AAAyH;AACzH;AACgE;AACL;;;AAG3D;AAC+K;AAC/K,gBAAgB,sLAAU;AAC1B,EAAE,kFAAM;AACR,EAAE,uFAAM;AACR,EAAE,gGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,2FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,oSAEN;AACP;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjCA;AAAA;AAAA;AAAA;AAAqqB,CAAgB,mqBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;ACezrB,wH;AACA;AACA,MADA,kBACA;AACA;AACA,mBADA;AAEA,kBAFA;AAGA,wBAHA;AAIA,yBAJA;AAKA,mBALA;AAMA,gBANA,EAMA;AACA,gBAPA,EAOA;AACA,oBARA,EAQA;AACA,kBATA,EASA;AACA,gBAVA,EAUA;AACA,kBAXA;AAYA,eAZA,EAYA;AACA,gBAbA;AAcA,aAdA;AAeA,aAfA;AAgBA,cAhBA;AAiBA,gBAjBA;AAkBA,gBAlBA;;AAoBA,GAtBA;AAuBA,QAvBA,oBAuBA;AACA,kBADA,GACA,KADA;AAEA;AACA,oBADA,CACA;AACA;AACA;AACA,iBAJA,EAIA,KAJA,CAIA;AACA;AACA,iBANA,CAFA;;;AAWA,GAlCA;AAmCA,SAnCA,qBAmCA;AACA,kBADA,GACA,MADA;AAEA;AACA,qBADA;AAEA,kBAFA,CAEA;AACA,yBADA;AAEA,+FAFA,EAFA;;AAMA,kBANA,CAMA;AACA;AACA;AACA;AACA,eAVA;AAWA;;AAEA;AAfA,wCAgBA,oBAhBA,QAgBA,eAhBA;AAiBA;AACA;AACA;AACA;AACA;AACA,yDAtBA,CAsBA;AACA,+DAvBA,CAuBA;;AAEA;AACA;AACA;AACA;AACA,+BADA;AAEA,0BAFA;AAGA,+BAHA;AAIA,8BAJA;;AAMA;AACA;AACA;AACA,yCAHA,CAGA;AACA,+DAJA,CAIA;;;AAGA;AACA,+EARA,CAQA;AACA,yGATA,CASA;AACA;AACA;;;;AAIA;AACA;AACA,sCAjBA,CAiBA;AACA,mDAlBA,CAkBA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,gCADA;AAEA,iCAFA;;AAIA;AACA;AACA,0CADA;AAEA,gCAFA;AAGA,qCAHA;AAIA;AACA;AACA;AACA;AACA;AACA,uBATA;AAUA;AACA;AACA,uBAZA;;AAcA,mBAfA,EAeA,GAfA;;AAiBA,iBAvBA;AAwBA,eApDA,EAoDA,GApDA;AAqDA;AACA;AACA;AAzFA,4EA0FA,CA7HA;AA8HA;AACA;AACA,gBAFA,wBAEA,KAFA,EAEA;AACA;AACA;AACA,oBADA;AAEA;AACA;AACA,WAJA;;AAMA,OAPA;AAQA,KAXA;;AAaA;AACA,iBAdA,2BAcA;AACA;AACA;AACA;AACA;AACA,WAHA;;AAKA,OANA;AAOA,KAtBA,EA9HA,E","file":"pages/invite/invitePoster.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/invite/invitePoster.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./invitePoster.vue?vue&type=template&id=72f59a13&\"\nvar renderjs\nimport script from \"./invitePoster.vue?vue&type=script&lang=js&\"\nexport * from \"./invitePoster.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/invite/invitePoster.vue\"\nexport default component.exports","export * from \"-!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./invitePoster.vue?vue&type=template&id=72f59a13&\"","var components\ntry {\n  components = {\n    uqrcode: function() {\n      return import(\n        /* webpackChunkName: \"uni_modules/uqrcode/components/uqrcode/uqrcode\" */ \"@/uni_modules/uqrcode/components/uqrcode/uqrcode.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./invitePoster.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../software/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./invitePoster.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"content\">\r\n\t\t<view style=\"position: fixed;top: -999px;left: 0;\">\r\n\t\t\t<uqrcode ref=\"uqrcode\" ></uqrcode>\r\n\t\t</view>\r\n\t\t<view v-if=\"show\">\r\n\t\t\t<canvas style=\"position: fixed;top: -999px;left: 0;\" :style=\"{ width: canvasW + 'px', height: canvasH + 'px' }\"\r\n\t\t\t canvas-id=\"myCanvas\" id=\"myCanvas\"></canvas>\r\n\t\t</view>\r\n\t\t<image v-if=\"img != ''\" style=\"width: 100%;\" :style=\"{height: canvasH  + 'px'}\" :src=\"img\" mode=\"\"></image>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\t// import {site} from '../../api/mySelf.js'\r\n\timport uQRCode from '../../uni_modules/Sansnn-uQRCode/js_sdk/u-qrcode';\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttitle: '邀请好友',\r\n\t\t\t\tisback: true,\r\n\t\t\t\tbackground: '#FFF',\r\n\t\t\t\ttxtColor: '#A4A4A4',\r\n\t\t\t\tbackColor: '',\r\n\t\t\t\tcanvasW: 0, // 画布宽\r\n\t\t\t\tcanvasH: 0, // 画布高\r\n\t\t\t\tSystemInfo: {}, // 设备信息\r\n\t\t\t\tgoodsImg: {}, // 商品主图\r\n\t\t\t\tewmImg: {}, // 二维码图片\r\n\t\t\t\totherImg: {},\r\n\t\t\t\tewmW: 120, // 二维码大小\r\n\t\t\t\tshow: true,\r\n\t\t\t\timg: '',\r\n\t\t\t\turl:'',\r\n\t\t\t\tlist: '',\r\n\t\t\t\turcode:'',\r\n\t\t\t\ttip:false\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync onLoad() {\r\n\t\t\tlet that = this\r\n\t\t\tawait that.$request('get', 'user/poster', {\r\n\t\t\t}).then(res => {\r\n\t\t\t\tconsole.log('res', res)\r\n\t\t\t\tthat.goodsImg = res.data.values.file_path\r\n\t\t\t}).catch(err => {\r\n\t\t\t\tconsole.log('err', err)\r\n\t\t\t})\r\n\t\t\t// that.goodsImg =\r\n\t\t\t// \t'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_bt%2F0%2F13095219924%2F641.jpg&refer=http%3A%2F%2Finews.gtimg.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1632382809&t=0dcf193e2a1651c72dd95945459c1bf4'\t\t\r\n\t\t},\r\n\t\tasync onReady() {\r\n\t\t\tlet that = this\r\n\t\t\t\tthat.$refs\r\n\t\t\t\t\t.uqrcode\r\n\t\t\t\t\t.make({\r\n\t\t\t\t\t\tsize: 354,\r\n\t\t\t\t\t\ttext: that.$config.inviteUrl + '?code=' + uni.getStorageSync('userinfo').userId\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t// 返回的res与uni.canvasToTempFilePath返回一致\r\n\t\t\t\t\t\tconsole.log(res,'res')\r\n\t\t\t\t\t\tthat.urcode = res.tempFilePath\r\n\t\t\t\t\t})\r\n\t\t\t// })\r\n\t\t\t\r\n\t\t\t// 获取设备信息，主要获取宽度，赋值给canvasW 也就是宽度：100%\r\n\t\t\tthat.SystemInfo = await that.getSystemInfo();\r\n\t\t\t// 获取商品主图，二维码信息，APP端会返回图片的本地路径（H5端只能返回原路径）\r\n\t\t\t// that.goodsImg = await that.getImageInfo('http://hjccloud.cn/h5/uploads/20201225142312e197f2881.jpg');\r\n\t\t\t// that.ewmImg = await that.getImageInfo('http://hjccloud.cn/h5/uploads/20201225142312e197f2881.jpg');\r\n\t\t\t// that.otherImg = await that.getImageInfo(that.list.logo);\r\n\t\t\tconsole.log('ssa', that.otherImg)\r\n\t\t\tthat.canvasW = that.SystemInfo.windowWidth; // 画布宽度\r\n\t\t\tthat.canvasH = that.SystemInfo.windowHeight - 44; // 画布高度 = 主图高度+二维码高度 + 文字图片的间距（大概50）\r\n\r\n\t\t\t// 如果主图，二维码图片，设备信息都获取成功，开始绘制海报，这里需要用setTimeout延时绘制，否则可能会出现图片不显示。\r\n\t\t\t// if(that.goodsImg.errMsg == 'getImageInfo:ok' && that.ewmImg.errMsg == 'getImageInfo:ok' && that.otherImg.errMsg == 'getImageInfo:ok' && that.SystemInfo.errMsg == 'getSystemInfo:ok'){\r\n\t\t\tconsole.log('ok')\r\n\t\t\tuni.showToast({\r\n\t\t\t\ticon: 'loading',\r\n\t\t\t\tmask: true,\r\n\t\t\t\tduration: 10000,\r\n\t\t\t\ttitle: '海报绘制中',\r\n\t\t\t});\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tvar ctx = uni.createCanvasContext('myCanvas', that);\r\n\t\t\t\t// 填充背景色，白色\r\n\t\t\t\tctx.setFillStyle('#fff'); // 默认白色\r\n\t\t\t\tctx.fillRect(0, 0, that.canvasW, that.canvasH) // fillRect(x,y,宽度，高度)\r\n                 \r\n\t\t\t\t \r\n\t\t\t\t// 绘制商品主图，二维码\r\n\t\t\t\tctx.drawImage(that.goodsImg, 0, 0, that.canvasW, that.canvasH) // drawImage(图片路径,x,y,绘制图像的宽度，绘制图像的高度)\r\n\t\t\t\tctx.drawImage(that.urcode, that.canvasW - 260, that.canvasH - 220, that.ewmW, that.ewmW) // drawImage(图片路径,x,y,绘制图像的宽度，绘制图像的高度,二维码的宽,高)\r\n\t\t\t\t// ctx.drawImage(that.otherImg, 40, 40, 70, 70)\r\n\t\t\t\t// 3、绘制商品标题，多余文字自动换行\r\n                \r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t/* str 这段代码是我百度找的，参考别人的。canvas不能自动换行，需要自行计算 */\r\n\t\t\t\tlet _strlineW = 0;\r\n\t\t\t\tlet _strLastIndex = 0; //每次开始截取的字符串的索引\r\n\t\t\t\tlet _strHeight = that.canvasW + 30; //绘制字体距离canvas顶部的初始高度\r\n\t\t\t\tlet _num = 1;\r\n\r\n\t\t\t\t// 5、邀请信息\r\n\t\t\t\tctx.setFontSize(17)\r\n\t\t\t\tctx.setFillStyle('#FFF')\r\n\t\t\t\tctx.fillText('推荐码: ' + uni.getStorageSync('userinfo').userId,that.canvasW / 2.8 + 10, that.canvasH - 60);\r\n\t\t\t\tctx.fillText('扫一扫，参与精彩', that.canvasW / 2.8, that.canvasH - 30);\r\n\r\n\r\n\t\t\t\tctx.draw(true, (ret) => { // draw方法 把以上内容画到 canvas 中。\r\n\t\t\t\t\tconsole.log(ret)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\ttitle: '绘制完成',\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsetTimeout(() => { /* 大坑，Android真机上必须setTimeout延时后保存，不然会出错~~~开发者工具上无问题，ios下也无问题 */\r\n\t\t\t\t\t\tuni.canvasToTempFilePath({ // 保存canvas为图片\r\n\t\t\t\t\t\t\tcanvasId: 'myCanvas',\r\n\t\t\t\t\t\t\tquality: 1,\r\n\t\t\t\t\t\t\tfileType: 'jpg',\r\n\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\t// 在H5平台下，tempFilePath 为 base64, // 图片提示跨域 H5保存base64失败，APP端正常输出临时路径\r\n\t\t\t\t\t\t\t\tconsole.log('res', res)\r\n\t\t\t\t\t\t\t\tthat.show = false\r\n\t\t\t\t\t\t\t\tthat.img = res.tempFilePath\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail: function(errInfo) {\r\n\t\t\t\t\t\t\t\talert('no', errInfo)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}, 500)\r\n\r\n\t\t\t\t})\r\n\t\t\t}, 500)\r\n\t\t\t// }else{\r\n\t\t\t// \tconsole.log('err')\r\n\t\t\t// }\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 获取图片信息\r\n\t\t\tgetImageInfo(image) {\r\n\t\t\t\treturn new Promise((req, rej) => {\r\n\t\t\t\t\tuni.getImageInfo({\r\n\t\t\t\t\t\tsrc: image,\r\n\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\treq(res)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\t// 获取设备信息\r\n\t\t\tgetSystemInfo() {\r\n\t\t\t\treturn new Promise((req, rej) => {\r\n\t\t\t\t\tuni.getSystemInfo({\r\n\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\treq(res)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t},\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\n"],"sourceRoot":""}